SELECT categories."Retention Status" AS category, COUNT(a."Retention Status") AS value, CASE WHEN (SELECT COUNT(*) FROM analysis.fact_sentinel_event WHERE "Retention Status" IN ('In Care','Missed Appointments', 'Treatment Interruptions')) = 0 THEN '0%' ELSE CONCAT(ROUND((COUNT(a."Retention Status") * 100.0 / (SELECT COUNT(*) FROM analysis.fact_sentinel_event WHERE "Retention Status" IN ('In Care','Missed Appointments', 'Treatment Interruptions')  )), 1), '%') END AS percentage FROM (SELECT 'In Care' AS "Retention Status" UNION ALL SELECT 'Missed Appointments' UNION ALL SELECT 'Treatment Interruptions') AS categories LEFT JOIN (SELECT "Tri Pillar Age Group", "Retention Status", "Sex", "Last Care Model" FROM analysis.fact_sentinel_event WHERE ("Sex" = '$sex' OR '$sex' = '') AND "Retention Status" IN ('In Care','Missed Appointments', 'Treatment Interruptions') ) a ON categories."Retention Status" = a."Retention Status" GROUP BY categories."Retention Status" ORDER BY CASE WHEN categories."Retention Status" = 'In Care' THEN 1 WHEN categories."Retention Status" = 'Missed Appointments' THEN 2 WHEN categories."Retention Status" = 'Treatment Interruptions' THEN 3 END