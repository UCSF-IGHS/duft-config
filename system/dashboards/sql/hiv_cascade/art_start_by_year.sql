SELECT d.year AS category, COUNT(se.first_art_date) AS value FROM mamba_fact_sentinel_event se INNER JOIN mamba_dim_client c ON se.client_id = c.client_id INNER JOIN mamba_dim_date d ON se.first_art_date = d.full_date LEFT JOIN mamba_dim_agegroup ag ON ag.age = c.current_age WHERE (Gender ='$gender' OR '$gender'='')  AND (datim_agegroup='$agegroup' OR '$agegroup'='') GROUP BY d.year;